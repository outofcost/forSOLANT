# Dev // Collections API // Поддержка типов коллекций и тип-зависимых полей

## 1. Проблема / цель

Во фронтенде Collections разделены на три вкладки:

- Main Page
- Collection Bar
- Game Page

В зависимости от **Type** фронтенд:
- отображает разные наборы столбцов в таблице;
- использует разные поля в Add / Edit Collection.

API должно корректно поддерживать:
- разделение коллекций по типам;
- разные структуры данных для каждого типа;
- расширение структуры таблиц (новые поля);
- корректную и стабильную отдачу данных для фронтенда.

---

## 2. Что нужно сделать

### 2.1. Разделение коллекций по вкладкам

В API получения коллекций  
`GET /collections`

- каждая коллекция **обязана** возвращать корректное поле `type`:
  - `main_page`
  - `collection_bar`
  - `game_page`
- фронтенд фильтрует коллекции по `type`,  
  но API должно возвращать **полный и валидный набор данных** для всех типов.

---

### 2.2. Поля таблиц во вкладках (поддержка в API)

API должно корректно возвращать следующие поля в зависимости от типа коллекции.

#### Main Page
- language list
- enabled
- order / position
- lines_to_display
- show_in_sidebar
- games_count
- categories
- countries

#### Collection Bar
- language list
- enabled
- order / position
- games_count
- categories
- countries

#### Game Page
- language list
- enabled
- order / position
- lines_to_display
- games_count
- categories
- countries

---

### 2.3. Add / Edit Collection — тип-зависимые поля

#### Main Page

API должно **принимать и сохранять**:
- icon_menu
- icon_sidebar
- icon_search
- icon_active_sidebar
- show_in_sidebar
- lines_to_display
- position

---

#### Collection Bar

API должно **принимать и сохранять**:
- icon_menu
- icon_hover
- icon_active
- position

API должно **игнорировать / не принимать**:
- show_in_sidebar
- lines_to_display

---

#### Game Page

API должно **принимать и сохранять**:
- icon (одно изображение — бывший `icon_menu`)
- lines_to_display
- position

API должно **игнорировать**:
- icon_hover
- icon_active
- show_in_sidebar

---

### 2.4. Валидация

- Поле `type` **обязательно** при создании коллекции.
- При редактировании коллекции:
  - `type` должен игнорироваться;
  - тип коллекции остаётся неизменным.
- Если фронтенд отправляет поля, не относящиеся к текущему типу:
  - либо API игнорирует их,
  - либо возвращает ошибку (на усмотрение реализации).

---

### 2.5. Edit Collection — таблица игр

Таблица игр внутри коллекции:
- остаётся без изменений;
- изменений в API не требуется.

---

## 3. Критерии приёмки

- API корректно возвращает коллекции с актуальными полями для каждого типа.
- Add / Edit Collection принимает и возвращает поля **строго по типу**:
  - Main Page — полный набор изображений + sidebar + lines
  - Collection Bar — 3 изображения, без sidebar и lines
  - Game Page — одно изображение, без sidebar / hover / active
- `type` не изменяется при редактировании коллекции.

---

## 4. Когда будете передавать задачу, приложите

- Все детали изменений эндпоинтов описать в комментариях к задаче **SD-2931**.

---

# Dev // Payment Management (Backoffice) // Мультиязычный Title в Payment Method Group

## 1. Проблема / цель

Сейчас сущность **Payment Method Group** хранит `Title` как одно языковое значение (строка).

Во фронтовой админке требуется возможность задавать **разные значения Title для разных языков**  
(RU / EN / CN и т.д.).

В продукте уже есть аналогичная логика в модалке **Add Bonus**.

Цель:
- расширить модель и API Payment Method Group;
- поддержать хранение и передачу `Title` в нескольких языках;
- использовать существующий механизм мультиязычности (как в Bonus).

---

## 2. Что нужно сделать

### 2.1. Анализ текущей реализации

- Найти текущую модель / таблицу для Payment Method Group.
- Проанализировать реализацию мультиязычных полей в модалке **Add Bonus**.
- Использовать существующий механизм переводов,  
  либо реализовать отдельный, если архитектура отличается.

---

### 2.2. Обновление модели данных

- Расширить модель Payment Method Group для хранения `Title` в нескольких языках.

---

### 2.3. Обновление API

Обновить endpoints Payment Method Group:
- создание;
- редактирование;
- получение данных.

API должно поддерживать работу с мультиязычным `Title`.

---

## 3. Критерии приёмки

### В базе данных

- Возможность хранить несколько значений `Title` для одной Payment Method Group (по языкам).
- Старые записи корректно мигрированы:
  - существующее значение `Title` становится переводом для дефолтного языка.

### В API

- При создании группы можно передать `Title` сразу для нескольких языков.
- При редактировании:
  - обновлять существующие переводы;
  - добавлять новые;
  - удалять лишние.
- При получении группы возвращается структура `Title` с несколькими языками.

### Во фронтенде

- Новый контракт используется без дополнительных костылей.
- Создание и редактирование работают корректно.
- Старые кейсы (где был один `Title`) не ломаются:
  - группы успешно открываются;
  - данные корректно отображаются и редактируются.

---

## 4. Когда будете передавать задачу, приложите

- Примеры:
  - POST / PUT запросов с `Title` на нескольких языках;
  - GET ответа для группы с несколькими переводами.
- Добавить комментарий в задачу **SD-2280**:
  `Dev // Payment Management (Backoffice) // Мультиязычный Title в Add/Edit Payment Method Group`
- Провести QA testing.
